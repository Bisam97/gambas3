' Gambas class file

'&HC00F47& = red
'&H4BC021& = green

Public a As Integer
Public b As Integer
Public c As Integer
Public d As Integer

Public Sub Button1_Click()

  'for checking valid values
   a = CInt(textbox1.text)
   b = CInt(textbox2.text) * 60
   
  ' on or off 
  If Button1.Text = "Start" Then

    ' are the values valid?
    If a >= 0 And b >= 0 And 0 <> a + b Then
   
     'switching on timer1
     timer1.enabled = True
     
     'for countdown
     c = (a + b) / 60
     d = (a + b) Mod 60
     textbox1.Text = d
     textbox2.text = c
     
     'for the right look
     button1.Text = "Stop"
     button1.Background = &HC00F47&
     
   'if the values are not valid
   Else 
     message.error(("Please fill in valid values!"))
   Endif
   
  'if it is already on
  Else
    'switching off timer1 and timer2 and changes in the look
    button1.Text = "Start"
    button1.Background = &H4BC021&
    timer1.enabled = False
  Endif
   
'thank you Benoit, that is just a great thing
Catch
 message.Error(("Please fill in valid values!")) 

End

Public Sub Timer1_Timer()

  'how the countdown works
  If c = 0 And d = 0 Then
  'timer1 switchs off himself and writes a message 
    timer1.Enabled = False
    button1.Text = "Start"
    button1.Background = &H4BC021&
    message.info(("Time is over!"))
  Else 
    If d = 0 Then
      c = c - 1 
      d = d + 59
    Else 
      d = d - 1
    Endif
  Endif

  'show the countdown
  textbox1.Text = d
  textbox2.text = c

End
