' Gambas class file



Public Sub Form_Open()

  Dim s As String
  'Dim hDesktop As New DesktopFile
  Dim sPath As String = User.home
  Dim hFilemime As DesktopMime
  Dim sKey As String
  'ColumnView1.Columns.Count = 2
  For Each s In Dir(sPath, "*", gb.File)
    sKey = sPath &/ s
    If s Begins "." Then Continue
    ColumnView1.Add(sKey, s)
    hFilemime = DesktopMime.fromfile(sPath &/ s)
    'ColumnView1[sKey][1] = hFilemime.Type
    Try ColumnView1[sKey].Picture = hFilemime.GetIcon(48).Picture
  Next
  
  ' For Each hFilemime In DesktopMime
  '   Print hFilemime.Type
  ' Next
  
  
End

Public Sub ColumnView1_Activate()

  Try DesktopFile.FindMime(ColumnView1[ColumnView1.Current.Key][1])[0].run(ColumnView1.Current.Key)

End

Public Sub ColumnView1_Click()
  Dim hFile As DesktopFile
  If Mouse.Right Then
    For Each hFile In DesktopMime.FromFile(ColumnView1.Key).GetApplications()
      Print hFile.Exec
    Next
  Endif

End
