' Gambas class file

Export
Inherits _XmlReader

Property InputStream As Stream
Property Read Eof As Boolean
Property Read State As Integer

Private $stream As Stream
Private $state As Integer = 0

Private Function InputStream_Read() As Stream

  Return $stream

End

Private Sub InputStream_Write(Value As Stream)

  $stream = Value

End

Public Function Read() As Integer
  
  Dim sBuf As String
  
  If Not $stream Then Return False
  If Eof($stream) Then Return
  
  Do
    sBuf = Read #$stream, 1
    $state = Me._ReadChar(sBuf)
  Loop Until ($state <> 0 And Me.ReadFlags[$state]) Or Eof($stream)
  
  If Eof($stream) Then Return XmlReaderNodeType.EndStream
  Return $state
  
End

Public Sub Open(path As String)
  
  Dim fichier As File
  If Left(Path) <> "/" Then Path = ".." &/ Path
  fichier = Open path For Input
  Me.InputStream = fichier
  
End


Private Function Eof_Read() As Boolean

  If Not $stream Then Return False
  Return Eof($stream)

End

Private Function State_Read() As Integer

  Return $state

End
