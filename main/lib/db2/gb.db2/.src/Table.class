' Gambas class file

Export

'   GB_METHOD("_free", NULL, CTABLE_free, NULL),
' 
'   //GB_METHOD("AddField", NULL, CTABLE_add_field, "(Name)s(Type)i[(Length)i(Default)v"])
' 
'   GB_PROPERTY_READ("Name", "s", CTABLE_name),
'   GB_PROPERTY_READ("System", "b", CTABLE_system),
'   GB_PROPERTY("PrimaryKey", "String[]", CTABLE_primary_key),
'   GB_PROPERTY("Type", "s", CTABLE_type),
'   GB_PROPERTY_READ("Connection", "Connection", CTABLE_connection),
' 
'   GB_METHOD("Update", NULL, CTABLE_update, NULL),
' 
'   GB_PROPERTY_READ("Fields", ".Table.Fields", CTABLE_fields),
'   GB_PROPERTY_READ("Indexes", ".Table.Indexes", CTABLE_indexes),
' 
'   GB_END_DECLARE

Property Read Name As String Use $sName
Property Read System As Boolean Use $bSystem
Property PrimaryKey As String[]
Property Type As String
Property Read Connection As Connection
Property Read Fields As _TableFields
Property Read Indexes As _TableIndexes

Private $hDriver As _DatabaseDriver
Private $hFields As _TableFields
Private $hIndexes As _TableIndexes

Public Sub _Fill(hDriver As _DatabaseDriver, sName As String)
  
  $hDriver = hDriver
  $sName = sName
  $bSystem = hDriver.IsSystemTable(sName)
  
End

Public Sub Update()
  
  
  
End

Private Function PrimaryKey_Read() As String[]

  

End

Private Sub PrimaryKey_Write(Value As String[])

  

End

Private Function Type_Read() As String

  

End

Private Sub Type_Write(Value As String)

  

End

Private Function Connection_Read() As Connection

  Return Object.Parent($hDriver)

End

Private Function Fields_Read() As _TableFields

  If Not $hFields Then 
    $hFields = New _TableFields As "TableFields"
    $hFields._Fill($hDriver, $sName)
  Endif 
  
  Return $hFields

End

Private Function Indexes_Read() As _TableIndexes

  If Not $hIndexes Then 
    $hIndexes = New _TableIndexes
    $hIndexes._Fill($hDriver, $sName)
  Endif 
  
  Return $hIndexes

End
