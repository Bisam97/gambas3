' Gambas class file

Public Const {Point} As Integer = 1
Public Const MultiPoint As Integer = 8
Public Const Polyline As Integer = 3
Public Const Polygon As Integer = 5
Property Read Count As Integer
Property Read Max As Integer


Private Items As New _ShapeItem[]

Private iType As New Integer[]
Private oData As New Object[]
Private $aBox As New RectF[]
Public Sub AddMultiPoint(Data As MapPoint[])
  Dim hSItem As New _ShapeItem
  hSItem.Type = MultiPoint
  hSItem.Data = Data
  hSItem.Box = GetDataBox(data)
  Items.Add(hSItem)
End

Public Sub AddPoint(Data As MapPoint)
Dim hSItem As New _ShapeItem
  hSItem.Type = Shapes.Point
  hSItem.Data = Data
  hSItem.Box = RectF(Data.Lat, Data.lon, 1, 1)
  Items.Add(hSItem)
  'RectF = GetDataBox(data)
End

Public Sub AddPolyline(Data As MapPoint[])
  Dim hSItem As New _ShapeItem
  hSItem.Type = Polyline
  hSItem.Data = Data
  hSItem.Box = GetDataBox(data)
  Items.Add(hSItem)
End

Public Sub AddPolygon(Data As MapPoint[][])
  Dim hSItem As New _ShapeItem
  hSItem.Type = Polygon
  hSItem.Data = Data
  hSItem.Box = GetDataBox(data)
  Items.Add(hSItem)
End


Private Function GetDataBox(hMapPoints As MapPoint[]) As RectF

  Dim hPoint As MapPoint
  Dim hRectF As New RectF
  hRectF.x = hMapPoints[0].Lon
  hRectF.y = hMapPoints[0].Lat
  For Each hPoint In hMapPoints
    hRectF.x = Min(hMapPoints.lon, hRectF.x)
    hRectF.y = Min(hMapPoints.lat, hRectF.y)
    hRectF.Right = Max(hMapPoints.lon, hRectF.Right)
    hRectF.Bottom = Max(hMapPoints.lat, hRectF.Bottom)
  Next
  Return hRectF
End

Public Sub _get(Index As Integer) As _ShapeItem
  Return Items[Index]
End

Private Function Count_Read() As Integer

  Return Items.Count

End

Private Function Max_Read() As Integer

  Return Items.Max

End
