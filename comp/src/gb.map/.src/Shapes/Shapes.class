' Gambas class file

Const {Point} As Integer = 1
Const MultiPoint As Integer = 8
Const Polyline As Integer = 3
Const Polygon As Integer = 5

Private iType As New Integer[]
Private oData As New Object[]
Private $aBox As New RectF[]
Public Sub AddMultiPoint(Data As MapPoint[])
  iType.Add(MultiPoint)
  oData.Add(Data)
  $aBox.Add(GetDataBox(data))
End

Public Sub AddPoint(Data As MapPoint)
    iType.Add(MultiPoint)
  oData.Add(Data)
  $aBox.Add(RectF(0, 0, 0, 0))
  'RectF = GetDataBox(data)
End

Public Sub AddPolyline(Data As MapPoint[])
    iType.Add(MultiPoint)
  oData.Add(Data)
  RectF.Add(GetDataBox(data))
End

Public Sub AddPolygon(Data As MapPoint[][])
    iType.Add(MultiPoint)
  oData.Add(Data)
  RectF.Add(GetDataBox(data[0]))
End


Private Function GetDataBox(hMapPoints As MapPoint[]) As RectF

  Dim hPoint As MapPoint
  Dim hRectF As New RectF
  hRectF.x = hMapPoints[0].Lon
  hRectF.y = hMapPoints[0].Lat
  For Each hPoint In hMapPoints
    hRectF.x = Min(hMapPoints.lon, hRectF.x)
    hRectF.y = Min(hMapPoints.lat, hRectF.y)
    hRectF.Right = Max(hMapPoints.lon, hRectF.Right)
    hRectF.Bottom = Max(hMapPoints.lat, hRectF.Bottom)
  Next
  Return hRectF
End



