' Gambas class file

Inherits _MapLayer
Private $hShapes As New Shapes
Private $himgPoint As Image
Property Data As Shapes

Public Sub _new(Optional hShape As Shapes)
  
  $himgPoint = Image.Load("point.png")
  
End

Public Sub Load()
  
  
  
  
End

Public Sub AddPoint(Data As MapPoint)
  
  $hShapes.AddPoint(Data)
  
End


Public Sub Draw()
  
  Dim hItem As _ShapeItem
  Dim i As Integer
  Dim pt As Point
  Dim hMap As Map = GetMap()

  If $hShapes.Count = 0 Then Return
  For i = 0 To $hShapes.Max
    pt = Geo.MapPointToPixel($hShapes[i].Data, hMap.zoom)
    Paint.Brush = Paint.Color(Color.Green)
    'Paint.Arc(pt.X - hMap.PixelBox.X, pt.Y - hMap.PixelBox.Y, 5)
    Paint.DrawImage($himgPoint, pt.X - hMap.PixelBox.X - 16, pt.Y - hMap.PixelBox.Y - 32)
    Paint.Fill
  Next
  
End

Private Function Data_Read() As Shapes

  Return $hShapes

End

Private Sub Data_Write(Value As Shapes)

  $hShapes = Value

End

Public Function GetMap() As Map
  
  Return Object.Parent(Me)
  
End
