' Gambas class file

Export
Inherits TermContainer
Class Rect
Property Text, Title As String
Private $sText As String

Property Maximized As Boolean

Private $rectOldPos As Rect

Private $bMaximized As Boolean

Public Sub _new()
  
  Me.Visible = False
  
End




Public Sub _Render()

  Dim i As Integer
  Dim hAttr As New Attr
  Dim iAttr As Integer

  Super._Render

  If Not Me._NeedRender Then Return

  hAttr.Background = TermColor.Red
  hAttr.Foreground = TermColor.White
  hAttr.Bold = True
  iAttr = hAttr.GetInteger()

  For i = 0 To Me.Width - 1 '- 2
    Me._Content[0][i] = Char(" ", iAttr)
  Next
  Me._Content[0][0].c = Asc("[")
  Me._Content[0][1].c = Asc("]")
  For i = 1 To String.Len($sText)
    Try Me._Content[0][i + 2].c = Asc(Mid($sText, i, 1))
  Next
  Me._Content[0][Me._Content[0].Max].c = Asc("X")
  Me._NeedRender = False

End

Private Function Text_Read() As String

  Return $sText

End

Private Sub Text_Write(Value As String)

  $sText = Value
  Me._NeedRender = True

End

Public Sub _Arrange()

  Me._GetClientRect().Move(0, 1, Me.W - 1, Me.Height - 1)
  Super._Arrange

End



Private Function Maximized_Read() As Boolean

  Return $bMaximized

End

Private Sub Maximized_Write(Value As Boolean)
  If $bMaximized = Value Then Return
  $bMaximized = Value

  If $bMaximized Then
    $rectOldPos = Me._GetRect()
    Me.Move(0, 0, Desktop.Width, Desktop.Height)
    
  Else
    Me.Move($rectOldPos.Left, $rectOldPos.Top, $rectOldPos.Width, $rectOldPos.Height)
  Endif


End


Public Sub _ScreenResize()
  
   If $bMaximized Then 
      Me.Move(0, 0, Desktop.Width, Desktop.Height)
     
   Endif
  
End

Public Sub Center()

  Me.Move((Desktop.Width - Me.Width) / 2, (Desktop.Height - Me.Height) / 2, Me.Width, Me.Height)
  
End

Public Sub Close()
  Dim hCont As TermControl
  Me.Visible = False
  TermWindows.Delete(Me)
  
End


Public Sub _MouseUp()

  
  
  If Mouse.ScreenY = Me.ScreenY Then
    If Mouse.ScreenX = Me.ScreenX + Me.Width - 1 Then 
      Me.Close
      Return
    Endif
    If Mouse.X >= 0 And If Mouse.x <= 1 Then
      Me.Maximized = Not Me.Maximized
    Endif
  Endif
  Super._MouseUp
  
  
End

Public Sub _MouseMove()
  If Mouse.Left Then
  If Mouse.ScreenY = Me.ScreenY Then
    
  Endif
  Endif
  Super._MouseMove
End


