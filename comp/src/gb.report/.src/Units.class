' Gambas class file

Static Public AllowedUnits As String[] = ["m", "cm", "mm", "in", "pt", "px"]

Static Public Function GetFactorUnitToInch(Unit As String) As Float

  Select Case Unit
    Case "cm"
      Return 0.3937
    Case "ft"
      Return 12
    Case "in"
      Return 1
    Case "m"
      Return 39.37
    Case "mm"
      Return 0.03937
    Case "px", "pt"
      Return 1 / Paint.ResolutionX
  End Select

End

Static Public Function UnitsConverter(Value As Float, Unit1 As String, Unit2 As String) As Float
  
  Dim fInch As Float
  Dim f As Float
  
  f = GetFactorUnitToInch(Unit1)
  finch = value * f
  f = GetFactorUnitToInch(Unit2)
  Return finch / f
  
End

Static Public Function CmToUnit(Value As Float, Unit As String) As Float
  
  Dim fInch As Float
  Dim f As Float
  
  f = GetFactorUnitToInch("cm")
  finch = value * f
  f = GetFactorUnitToInch(Unit)
  Return finch / f
  
End

Static Public Function UnitToCm(Value As Float, Unit As String) As Float
  
  Dim fInch As Float
  Dim f As Float
  
  f = GetFactorUnitToInch(Unit)
  finch = value * f
  f = GetFactorUnitToInch("cm")
  Return finch / f
  
End




