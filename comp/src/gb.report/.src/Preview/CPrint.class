' Gambas class file

Create Static
Private hPrinter As New Printer As "Printer"
Private $hPrint As Report

Public Sub PrintReport(hReport As Report)

  Dim hSizeParse As TSizeParse

  $hPrint = hReport.Clone()
  hPrinter.Paper = $hPrint.Paper
  hPrinter.Orientation = $hPrint.Orientation
  If $hPrint.Paper = Printer.Custom Then
    hSizeParse = New TSizeParse($hPrint.Width)
    hPrinter.PaperWidth = hSizeParse.ToCm() / 10
    hSizeParse = New TSizeParse($hPrint.Height)
    hPrinter.PaperHeight = hSizeParse.ToCm() / 10
  Endif
  If Not hPrinter.Configure() Then
    hPrinter.Print
  Endif

End

Public Sub Printer_Draw()

  $hPrint.Paint(hPrinter.Page)

End

Public Sub Printer_Begin()

  'Debug Object.Type($hReport)
  $hPrint.Layout
  hPrinter.Count = $hPrint.PageCount

End

Public Sub Printer_End()

  $hPrint = Null

End
