' Gambas class file

Export
Inherits ReportVBox

Public Const _Properties As String = "*,Count"

Private $iCount As Integer
Property Count As Integer
Private $aContent As TControl[]
Private $bIsSet As Boolean = False


Private Function Count_Read() As Integer

  Return $iCount

End

Private Sub Count_Write(Value As Integer)
  
  ReInit
  $iCount = Value

End

Public Sub ReInit()
  Dim hChild As Object
  If $aContent = Null Then Return 
  Me.Children.Clear
  For Each hChild In $aContent
    Me._add(hChild.Ctrl)
  Next
  $aContent = Null
  
    
End


Private Sub GenerateChilds()
  
  Dim i As Integer
  Dim hChild As Object
  Dim nChild As Object
  Dim hClass As Class
  Dim s As String
  $aContent = Me.Children.Copy()
  Me.Children.Clear

  For i = 1 To $iCount
    For Each hChild In $aContent   
      nChild = Me._add(hChild.ctrl)
      nChild.VirtualId = i
    Next
  Next

  $bIsSet = True
End


Public Sub _GetSizeHints(AvailableW As Float, AvailableH As Float, TotalWidth As Float, TotalHeight As Float) As TSizeHint
  
  If Not $bIsSet Then GenerateChilds
  Return Super._GetSizeHints(AvailableW, AvailableH, TotalWidth, TotalHeight)
  
End

Public Function _SetChildGeometry(X As Float, Y As Float, W As Float, H As Float, ContPage As Integer) As Float
  Dim f As Float

  Super._SetChildGeometry(X, Y, W, H, ContPage)  
  Return f
  
End


Private Sub CopyObject(aroChild As Object[], hParent As Object, VirtualId As Integer)
  
End


Public Sub _free()
  
  Super._free
  
End



