' Gambas class file

'PRIVATE hc AS Report
'PRIVATE Pdf AS NEW PdfDocument 
Private hPic As Picture
Private fZoom As Integer
'Private hCon As New connection
'Private hResult As Result
Private hPrinter As New Printer
Private $aFirstNames As String[] = ["Leo", "Mario", "Nathan", "Thomas", "Fabien", "Laurent", "Benoit", "Charles", "Rob", "Ron"]
Private $aBornDates As String[] = ["1/12/1978", "24/10/1983", "18/04/1969", "15/05/1953", "12/12/1974", "16/11/1968", "30/06/1976", "3/11/1986", "05/08/1982", "23/10/1953"]
Public Sub _New()
  ' hcon.user = "root"
  ' hcon.host = "localhost"
  ' hcon.Type = "mysql"
  ' hcon.Name = "test"
  ' hResult = hcon.Find("test", "active=&1", TRUE)
  ' 'hcon.Open
  ComboBox1_Click
  hprinter.Paper = printer.A4
  
  
  'Test1()
  
End



Public Sub Test1()
  'DIM hReport 
  
  Dim hCont As ReportHBox
  Dim vCont As ReportVBox
  Dim txt As ReportLabel
  Dim spetxt As ReportSpecialField
  Dim img As ReportFrame
  Dim i, j As Integer
  Dim hCont2 As ReportContainer
  Dim vRef As ReportVBox
  Dim vDes As ReportVBox
  Dim vPU As ReportVBox
  Dim vQt As ReportVBox
  Dim vTot As ReportVBox
  Dim fPrix As Float
  Dim qte As Integer
  
  'hc = NEW Report(NULL)
  'Marges
  

  
  Report.Resolution = Desktop.Resolution
  report.size = "A4"
  report.orientation = report.Portrait
  'Report.Units = Units.cm 
  Report.Padding = "1 cm"
  Object.Attach(report, Me, "Report")
  Report.Spacing = "0.2 cm"
  Report.Border = ReportBorder.Solid
  Report.Tag = "Report"
  'Entete
    
  hCont = New ReportHBox(Report)
  hCont.Height = "3 cm"
  img = New ReportFrame(hCont)
  img.Image = Image.Load("new-logo.png")
  img.Width = "3 cm"
  img.Style = ReportStyle.Image
  'img.Height = "3 cm"
  img.Tag = "Image"
  
  txt = New ReportLabel(hcont)
  txt.Text = "Gambas Facture"
  txt.Alignment = Align.Center
  txt.Font = Font["32"]
  txt.Expand = True
  txt.Tag = "Titre"
  
  hCont = New ReportHBox(Report)
  hCont.Height = "5 cm"
  ' 
  vCont = New ReportVBox(hCont)
  vCont.Expand = True
  vCont = New ReportVBox(hCont)
  vCont.Width = "10 cm"
  vCont.Tag = "Container adresse"
  
  txt = New ReportLabel(vCont)
  txt.Text = "Gambas & Co"
  txt.Font.Size = "12 cm"
  txt.Font.Bold = True
  
  txt = New ReportLabel(vCont)
  txt.Text = "This Street"
  txt.Font.Size = "12 cm"
  txt.Font.Bold = True
  
  txt = New ReportLabel(vCont)
  txt.Text = "A City in France"
  txt.Font.Size = "12 cm"
  txt.Font.Bold = True
  ' 
  txt = New ReportLabel(vCont)
  txt.Text = "Tel/Fax: 00 000 000 000"
  txt.Font.Size = "12 cm"
  txt.Font.Bold = True
  ' 
  vCont = New ReportVBox(Report)
  vcont.Height = "2 cm"
  vCont.Tag = "Container n°fact/client"
  
  txt = New ReportLabel(vCont)
  txt.Text = "Client N° 0001"
  
  txt = New ReportLabel(vCont)
  txt.Text = "Facture N° 0001"
  
  ' vCont = NEW ReportVBox(Report)
  ' vCont.Height = "2 cm"
  ' vCont.Tag = "Container vide d'espacement"
  
  hCont = New ReportHBox(Report)
  hCont.Expand = True
  hCont.Spacing = "0.05 cm"
  hCont.Height = "10 cm"
  
  vCont = New ReportVBox(hCont)
  vCont.Width = "4.5 cm"
  'vCont.BorderStyle = line.Solid
  'vCont.Foreground = color.Red
  'vCont.FillStyle = Fill.Solid
  'vCont.FillColor = color.Red
  'vCont.Background = color.Red
  vCont.Spacing = "0.05 cm"
  vCont.Tag = "Container De colonne Ref"
  
    txt = New ReportLabel(vCont)
    txt.Text = "Ref"
    txt.Alignment = Align.Center
    txt.Font.Italic = True


    'txt.Width = 2
    txt.Border = ReportBorder.Solid
    txt.Color = Color.LightGray
    'txt.FillStyle = fill.Solid
    
    vRef = New ReportVBox(vCont)
    vRef.Expand = True
    
'    vRef = NEW ReportVBox(vcont)
    vRef.Border = ReportBorder.Solid
    vRef.Padding = "0.1 cm"
    vRef.Spacing = "0.1 cm"
    'vRef.Height = 5
     vRef.Tag = "Reference"
     VRef.Tag = "Container de donnée de ref"
    
  vCont = New ReportVBox(hCont)
  VcONT.Expand = True
   vCont.Spacing = "0.05 cm"
  ' 
    txt = New ReportLabel(vCont)
    txt.Text = "Designation"
    txt.Alignment = Align.Center
    txt.Font.Italic = True
    txt.Border = ReportBorder.Solid
    txt.Color = Color.LightGray
    txt.Style = ReportStyle.Solid
    
    vDes = New ReportVBox(vCont)
    vDes.Expand = True
    vDes.Border = ReportBorder.Solid
    vDes.Padding = "0.1 cm"
    vDes.Spacing = "0.1 cm"
    vDes.Tag = "* des"
    
  vCont = New ReportVBox(hCont)
  vCont.Width = "2.5 cm"
  vCont.Spacing = "0.05 cm"
  
    txt = New ReportLabel(vCont)
    txt.Text = "Quantitée"
    txt.Alignment = Align.Center
    txt.Font.Italic = True
    'txt.Width = "3,5 cm"
    txt.Border = ReportBorder.Solid
    txt.Color = Color.LightGray
    txt.Style = ReportStyle.Solid
    
    vQt = New ReportVBox(vCont)
     vQt.Expand = True
    vQt.Border = ReportBorder.Solid
    vQt.Padding = "0.1 cm"
    vQt.Spacing = "0.1 cm"
    vQt.Tag = "* Qt"
  vCont = New ReportVBox(hCont)
  vCont.Width = "2.5 cm"
  vCont.Spacing = "0.05 cm"
  
    txt = New ReportLabel(vCont)
    txt.Text = "Prix Unitaire"
    txt.Alignment = Align.Center
    txt.Font.Italic = True
    'txt.Width = "3,5 cm"
    txt.Border = ReportBorder.Solid
    txt.Color = Color.LightGray
    txt.Style = ReportStyle.Solid
    
    vPU = New ReportVBox(vCont)
    vPU.Expand = True
    vPU.Border = ReportBorder.Solid
    vPu.Padding = "0.1 cm"
    vPU.Spacing = "0.1 cm"
  
  vCont = New ReportVBox(hCont)
  vCont.Width = "2.5 cm"
  vCont.Spacing = "0.05 cm"
  
    txt = New ReportLabel(vCont)
    txt.Text = "Prix HT"
    txt.Alignment = Align.Center
    txt.Font.Italic = True
    'txt.Width = "3,5 cm"
    txt.Border = ReportBorder.Solid
    txt.Color = Color.LightGray
    txt.Style = ReportStyle.Solid
    
    vTot = New ReportVBox(vCont)
    vTot.Expand = True
    vTot.Border = ReportBorder.Solid
    vTot.Padding = "0.1 cm"
    vTot.Spacing = "0.1 cm"
    vTot.Tag = "Total"
    
  hCont = New ReportHBox(Report)
  hCont.Height = "1 cm"
  hCont.Color = Color.LightGray
  hCont.Border = ReportBorder.Solid
  hCont.Tag = "Container de total"
  
  spetxt = New ReportSpecialField(hCont)
  spetxt.Text = "Bas de facture $PAGE/$NPAGE"
  spetxt.Expand = True
  spetxt.Alignment = Align.Center
  
  For i = 1 To 50
  
    txt = New ReportLabel(vRef)
    txt.Alignment = Align.Right
    txt.Text = i
    
    txt = New ReportLabel(vDes)
    txt.Text = "Ma designation"
    txt.Alignment = Align.Left
    txt = New ReportLabel(vQt)
    qte = Rnd(1, 10)
    txt.text = qte
    txt.Alignment = Align.Right
    
    txt = New ReportLabel(vPU)
    fPrix = Round(Rnd(1, 100), -2)
    txt.text = fPrix
    txt.Alignment = Align.Right
    
    txt = New ReportLabel(vTot)
    txt.text = Str(qte * fPrix) & " €"
    txt.Alignment = Align.Right
    
      
  Next
  
End

' Public Sub Form_Open()
' 
'   Test4
' 
' End


Public Sub SpinBox1_Change()
  Dim zoomFactor As Float
  DrawingArea1.Clear
  
  Paint.Begin(DrawingArea1)
  report.Layout
  Paint.End
  SpinBox1.MaxValue = Report.Count
  zoomFactor = fZoom / 100
  DrawingArea1.Resize(Units.UnitsConverter(hPrinter.PaperWidth, "mm", "in") * Desktop.Resolution, Units.UnitsConverter(hprinter.PaperHeight, "mm", "in") * Desktop.Resolution)
  Paint.Begin(DrawingArea1)
  If SpinBox1.Value > Report.count Then Return 
  
  
  
    'Report.Calculate
    'Message(Report.count) 'draw.Scale(0.1, 0.1)
    report.Scale = zoomFactor
    'MRTools.ReportZoom = zoomFactor
    'Draw.Scale(zoomFactor, zoomFactor)
    Report.Draw(SpinBox1.Value)
    'Draw.Picture(hPic, 0, 0)
  Paint.End
  
End

Public Sub HBox1_MouseDown()

  

End

Public Sub ComboBox1_Change()

    SpinBox1_Change()

End

Public Sub ComboBox1_Click()
  fZoom = Val(ComboBox1.Text) '* Desktop.Resolution / Printer.Resolution
  SpinBox1_Change()

End

Public Sub MakePdf()
  Dim hTemp As String
  Dim i As Integer
  hTemp = Temp
  
  Printer.File = hTemp 
  Printer.Size = report.Size
  Printer.Orientation = report.Orientation
  'report.Height = 29.7
  'report.width = 21
  'Report.SheetSize = SheetSize.A4
  'Report.orientation = Report.Landscape
  'report.Units = 1
  report.Resolution = printer.Resolution
  Draw.Begin(Printer)
    'Draw.Scale(Val(ComboBox1.Text) / 100, Val(ComboBox1.Text) / 100)
   'Report.Calculate
   Report.Layout
   Message(Report.count)
   For i = 1 To Report.count
   
    Report.Draw(i)
    
    If i < Report.count Then Printer.NewPage()
    
   Next

  Draw.End  
  Exec ["ps2pdf", hTemp, user.Home &/ "Desktop/Test.pdf"] Wait
  Kill hTemp
  'pdf.Close
  'Pdf.Open(user.Home &/ "Desktop/Test.pdf")
  
  'SpinBox1.MaxValue = pdf.Count
  'SpinBox1_Change

End


Public Sub Button2_Click()
'Button1.Enabled = FALSE
MakePdf  

End



' PUBLIC SUB Test2()
'   
'   DIM tx AS ReportLabel
'   DIM tf AS ReportField
'   DIM table AS ReportTable 
'   DIM hTable AS Table
'   DIM hRF AS ResultField
'   report.Resolution = Desktop.Resolution
'   Report.Size = "A4"
'   report.orientation = report.Portrait
'   Report.Units = Units.cm
'   Report.Padding = 1
'   Object.Attach(report, ME, "Report")
'   Report.Spacing = 0.2
'   Report.BorderStyle = line.Solid
'   Report.Tag = "Report"
'   
'   tx = NEW ReportLabel(report)
'   tx.Text = hcon.user & "@" & hcon.Host & "/" & hcon.Name & " (test)"
'   tx.Padding = 0.08
'   tx.Font.Size = 24
'   tx.Alignment = align.Center
'   'report.Resolution = 0
'   table = NEW ReportTable(report) AS "ReportTable"
'   table.Expand = TRUE
'   hResult = db.Exec("SELECT * FROM test")
'   'table.Columns.Count = hResult.Fields.Count
'   FOR EACH hRF IN hResult.Fields
'    INC table.Columns.Count 
'    table.Columns[table.Columns.Count - 1].Text = hRF.Name
'   NEXT
'   
'  
'   Table.Rows.Count = hResult.Count
'   table.Header = 3
' 
'   '    tf = NEW ReportField(report)
'   ' tf.Text = "Page $PAGE/$NPAGE"
'   ' tf.Alignment = align.center
'   
'   
' END


' Public Sub ReportTable_Data(Row As Integer, Column As Integer)
'   Dim hlbl As ReportLabel
'   Dim hPic As ReportImage
'   If column = 1 Then 
'   hPIc = New ReportImage(Last.Data)
'   hPic.Path = "printer1.png"
'   hPic.Height = "1 cm"
'   Endif
'   hlbl = New ReportLabel(Last.data)
'   
'   If Row Mod 2 > 0 Then 
'     
'     Last.Data.FillColor = &hC0C0FF
'     Last.dATA.FillStyle = fILL.Solid
'   Endif
'   hResult.MoveTo(Row)  
'   hlbl.Text = hResult[Last.Columns[column].Text]
'   
' End

Public Sub Test3()
  
Dim hBox As ReportHBox
Dim hLabel As ReportLabel
Dim VBox As ReportVBox
Dim i As Integer
  report.orientation = report.Landscape
  report.Resolution = Desktop.Resolution
  report.Size = "A4"
  'Report.Units = 1
  Report.Padding = "1 cm"
  Object.Attach(report, Me, "Report")
  'Report.Spacing = "0.0 cm"
  Report.Border = ReportBorder.Solid
  Report.Tag = "Report"
  
  HBox = New ReportHBox(Report)
  hBox.Height = "2 cm" 
  hBox.Spacing = "2 %"
  For i = 1 To 4
  hLabel = New ReportLabel(hBox)
  
  hLabel.Width = "4.5 cm"
  hLabel.Border = ReportBorder.Solid
  'hLabel.FillStyle = Fill.Solid
  Next 
  HBox = New ReportHBox(Report)
  hBox.Height = "2 cm"
  For i = 1 To 6
  
    hLabel = New ReportLabel(hBox)
    hLabel.Width = "3 cm"
    hLabel.Border = ReportBorder.Solid
    'hLabel.FillStyle = Fill.Solid
  Next 
  hBox = New ReportHBox(report)
  HBox.Expand = True
  hBox.Border = ReportBorder.Solid
  hBox.Padding = "0.05 cm"
  hBox.Spacing = "0.05 cm"
  For i = 0 To 8
    VBox = New ReportVBox(hBox)
    VBox.Expand = True
    'VBox.Padding = "0.5 cm"
    'VBox.BorderStyle = line.Solid
    hLabel = New ReportLabel(vBox)
    hLabel.Text = "titi"
    hLabel.Border = ReportBorder.Solid
    VBox.Spacing = "0.05 cm"
    Vbox = New ReportVBox(Vbox)
    Vbox.Border = ReportBorder.Solid
    Vbox.Expand = True
  Next
End

' Public Sub Test4()
' 
' Dim hCont As New ReportHBox(report)
' Dim rCont As New ReportCloner(report)
' Dim hlabel As New ReportLabel(hCont)
' Dim hField As ReportField
' 'Dim hPic As ReportImage
' hCont.Height = "5 cm"
' 'hCont.Expand = TRUE
'   report.Size = "Custom"
'   report.Width = "20 cm"
'   Report.Height = "20 cm"
'   hlabel.Text = "Test of report repetor"
'   hLabel.Width = "5 cm"
'   hLabel = New ReportLabel(hCont)
'   hLabel.Expand = True
'   ' Draw.Begin(DrawingArea1)
'   '   report.Layout
'   '   report.Draw(1)
'   ' draw.end
'     hField = New ReportField(hCont) As "TField"
'   'hLabel.Text = "titi"
'   hField.Width = "2 cm"
'   rCont.Expand = True
'   hCont = New ReportHBox(rCont)
'   hCont.Height = "1 cm"
'   hCont.Border = ReportBorder.Solid
'   hPic = New ReportImage(hCont)
'   hPic.Path = "new-logo.png"
'   hPic.Width = "1 cm"
'   
'   hLabel = New ReportLabel(hCont)
'   hLabel.Text = "toto"
'   hLabel.Width = "2 cm"
' 
'   'object.Attach(hField, ME, "TField")
'   'hLabel.Expand = TRUE
'     hField = New ReportField(hCont) As "TField"
'   'hLabel.Text = "titi"
'   hField.Width = "2 cm"
'   rCont.Count = 100
'   hLabel = New ReportLabel(report)
'   hLabel.text = "bottom"
' End

Public Sub RadioButton1_Click()
  Report.Clear()
  Test1  
  SpinBox1_Change()
End

' PUBLIC SUB RadioButton2_Click()
'   Report.Clear
'   'Test2  
'   SpinBox1_Change()
' END

Public Sub RadioButton3_Click()
  Report.Clear
  Test3  
  SpinBox1_Change()
End

Public Sub CheckBox1_Click()

  Report.Debug = CheckBox1.Value  

End

Public Sub RadioButton4_Click()
  Report.Clear
  Test6  
  SpinBox1_Change()
  

End

Public Sub TField_Data()
  
  Last.Data = "Field" & Last.index
  If Last.id = 3 Then 
    Last.Font.Bold = True
    With Last.pARENT
      .BackGround = color.Blue
      .Color = color.Blue
      .Style = ReportStyle.Solid
      '.Foreground = Color.Blue
    End With 
  Endif
  
End

' Private Sub Test5()
'   
'   Dim hrep As ReportCloner
'   Dim hlab As ReportLabel
'   Dim hfi As ReportField
'   Dim hHb As ReportHBox
'   Dim vCon As ReportVBox
'   Dim spe As ReportSpecialField
'   
'   report.width = "21 cm"
'   report.Height = "29.7 cm"
'   report.BorderStyle = line.Solid
'   Report.Padding = "1 cm"
'   report.Resolution = Desktop.Resolution
'   'report.Debug = TRUE
'   hLab = New ReportLabel(Report)
'   hLab.Text = "REPETOR TEST"
'   hLab.Height = "2.5 cm"
'   
'   hLab.Alignment = Align.Center
'   hLab.Font.Size = 25
'   hLab.BorderStyle = Line.Solid
'   hLab.FillColor = Color.LightGray
'   hLab.FillStyle = fill.Solid
'   
'   vcon = New ReportVBox(Report)
'   vCon.Height = "1 cm"
'   
'   hrep = New ReportCloner(report)
'   hRep.Expand = True
'   hRep.Count = hResult.Count
'   hRep.Tag = "repetor"
'   hRep.Spacing = "0.2 cm"
'   
'   vCon = New ReportVBox(hrep)
'   vCon.Height = "1.5 cm"
'   vCon.Padding = "0.2 cm"
'   vCon.BorderStyle = line.Solid
' 
'   vCon.Tag = "vcon"
'   hHb = New ReportHBox(vcon)
'   
'   hHb.Height = "0.5 cm"
'   hHb.Tag = "hHb"
'   hlab = New ReportLabel(hHb)
'   hLab.Text = "Name :"
'   'hLab.Width = "2 cm"
'   
'   hLab.Font.Bold = True
'   hlab.Tag = "hLab"
'   hfi = New ReportField(hHb) As "FieldName"
'   hfi.tag = "FieldName"
'   hFi.BorderStyle = Line.Solid
'   'hFi.Padding = "0.1 cm"
'   hFi.Width = "4 cm"
'   hFi.Font.Bold = True
' 
'   hHb = New ReportHBox(vCon)
'   hHb.Height = "0.5 cm"
'   
'   hlab = New ReportLabel(hHb)
'   hLab.Text = "Firstname :"
'   'hLab.Width = "2 cm"
'   hLab.Foreground = color.Gray
'   hfi = New ReportField(hHb) As "FieldFirstName"
'   hfi.Tag = "FieldFirstName"
'   hFi.Width = "2 cm"
'   hFi.Font.Italic = True
'   hFi.Foreground = color.Gray
'   ' hHb = NEW ReportHBox(hrep)
'   ' hHb.Height = "1 cm"
'   
'   ' vcon = NEW ReportVBox(Report)
'   ' vCon.Height = "1 cm"
'   
'   spe = New ReportSpecialField(Report)
'   
'   spe.Text = "$PAGE/$NPAGE"
'   spe.Height = "1 cm"
'   spe.Alignment = align.Center
'   
' End

' Public Sub FieldName_Data()
' 'PRINT Index
'   hResult.MoveTo(Last.Index - 1)
'   Last.Data = hResult!name
'   If Index Mod 2 > 0 Then 
'     Last.parent.parent.fillcolor = color.Yellow
'     Last.parent.parent.fillstyle = fill.Solid
'   Else 
'     Last.parent.parent.fillstyle = fill.none
'   Endif
'   
'   Catch
' End

' Public Sub FieldFirstName_Data()
'   
'   hResult.MoveTo(Last.Index - 1)
'   Last.Data = hResult!firstname
'   Catch
' End
' 
' Public Sub Button1_Click()
' 
'   frmPreview.Run(report)  
' 
' End


Public Sub Test6()
  
  
Dim hLab As ReportLabel                 'A variable for ReportLabel
Dim hHBox As ReportHBox                 'A variable for ReportHBox
Dim hVBox As ReportVBox                 'A variable for ReportVBox
Dim hCloner As ReportCloner             'A variable for ReportCloner
Dim hField As New ReportField           'A variable for ReportField
Dim hSField As New ReportSpecialField   'A variable for ReportSpecialField

Report.Resolution = Desktop.Resolution  'Resolution to show at screen
Report.Padding = "2 cm"                 'Margins
Report.Spacing = "2 cm"
'Report.Zoom = 1                         'Zoom
'report.DEBUG = TRUE

'* Add a Label to Make the title
hLab = New ReportLabel(Report)
hLab.Text = "MY FRIENDS FIRST NAME"     'Set the text
hLab.Font = Font["Arial,+8,"]           'Set The Font
hLab.Alignment = Align.Center           'Set The aligment
hLab.Border = ReportBorder.Solid
hLab.Color = Color.LightGray
hLab.Style = ReportStyle.Solid

'* Add a Cloner to list what i want
hCloner = New ReportCloner(Report)
hCloner.Padding = "3 mm"                'Set the space arround the component
hCloner.Spacing = "3 mm"                'Set the space between the children
hCloner.Expand = True                   'Allow the Cloner to take all it's needed space

'* Put some components in the cloner

'* A VBox to contain the whole element information
hVBox = New ReportVBox(hCloner)
'hVBox.Height = "2 cm"                   'Force the height of the hBox
hVBox.Spacing = "2 mm"
hVBox.Padding = "1 mm"
hVBox.Border = ReportBorder.Dot
hVBox.Autoresize = True
'* An HBox to arrange the components horizontaly (for firstnames)
hHBox = New ReportHBox(hVBox)
hHBox.Height = "0.5 cm"                   'Force the height of the hBox
hHBox.Spacing = "2 mm"


'* A Label in the HBox
hLab = New ReportLabel(hHBox)
hlab.Text = "FirstName:"                'Set the Label Text
hLab.Font.Bold = True                   'Set the font bold
hlab.Width = "20 %"

'* A Field in the HBox
hField = New ReportField(hHBox) As "MyFieldFirstName"         'An handle is needed to get the datas
hField.Font.Italic = True               'Set the Field font italic
hField.Expand = True                    'Allow the Field to take all the space 

'* An HBox to arrange the components horizontaly (for BornDates)
hHBox = New ReportHBox(hVBox)
hHBox.Height = "0.5 cm"                   'Force the height of the hBox
hHBox.Spacing = "2 mm"

'* A Label in the HBox
hLab = New ReportLabel(hHBox)
hlab.Text = "BornDate:"                'Set the Label Text
hLab.Font.Bold = True                   'Set the font bold

'* A Field in the HBox
hField = New ReportField(hHBox) As "MyFieldBornDate"         'An handle is needed to get the datas
hField.Font.Italic = True               'Set the Field font italic
hField.Expand = True                    'Allow the Field to take all the space 


'* Add a SpecialField to show the page number
hSField = New ReportSpecialField(Report)
hSField.BorderColor = color.Gray          'Set the TextColor
hSField.Alignment = Align.Right         'Set the text alignment to the right
hSField.Text = "Page $PAGE/$NPAGE"      'Set the text containing macro keywords


hCloner.Count = $aFirstNames.Count      'Set the number of clone to make
'frmPreview.Run(report)
  
End


Public Sub MyFieldFirstName_Data()
  
  Last.Data = $aFirstNames[Last.Index - 1]
  
End

Public Sub MyFieldBornDate_Data()
  
  Last.Data = $aBornDates[Last.Index - 1]
  
End

Public Sub RadioButton2_Click()

    Report.Clear()
  Test7
  SpinBox1_Change()

End


Public Sub test7()
  
  Dim hHBox As ReportHBox
  report.Size = "A4"
  report.Orientation = report.Portrait
  report.Spacing = "1%"
  hHBox = New ReportHBox(report)
  hHBox.Height = "30%"
  
  hHBox.BorderWidth = 3
  hHBox.Border = ReportBorder.Solid
  
  
  
End

