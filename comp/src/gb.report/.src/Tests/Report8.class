' Gambas class file

Private hResult1 As Result
Private hResult2 As Result

Public Sub _new()

  Connections["Connection1"].Open
  'Report.Debug = True
  hResult1 = db.Exec("select distinct firstname from test")

  ReportPanel1.DataCount = hResult1.Count
  'ReportHBox1.DataCount = 4
  'ReportHBox1.Border.RoundCorner.TopRight = "5mm 5mm"
  'ReportHBox1.Border.RoundCorner.BottomRight = "5mm/5mm"

End

Public Sub ReportLabel1_Data(Index As Integer)

  hResult2.MoveTo(Index)
  Last.data = hResult2!name

End

Public Sub ReportPanel1_BeforeData()

  hResult1.MoveTo(Last.dataindex)
  hResult2 = db.Exec("Select * From test where firstname=&1", hResult1!firstname)
  ReportHBox1.DataCount = hResult2.Count

End

Public Sub ReportLabel2_Data(Index As Integer)

  hResult1.MoveTo(Index)
  Last.data = hResult1!firstname

End
