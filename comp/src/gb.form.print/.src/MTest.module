' Gambas module file

Private $hPrinter As Printer

Public Sub Main()

  $hPrinter = New Printer As "Printer"
  
  $hPrinter.Preview()

End

Public Sub Printer_Begin()
  
  Debug
  $hPrinter.Count = 3
  
End

Public Sub Printer_Draw()
  
  Dim H As Float
  
  Debug $hPrinter.Page;; "/";; Paint.W;; Paint.H

  Debug "Paint.ResolutionY = "; Paint.ResolutionY
  Debug "Paint.FontScale = "; Paint.FontScale
  Paint.Font = Font["Liberation Sans,10"]
  Debug "Paint.Font.Size = "; Paint.Font.Size
  Debug "Paint.Font.H = "; Paint.Font.H
  H = Paint.Font.H
  Paint.Font = Font["Liberation Sans,10"]
  Paint.DrawText(CStr($hPrinter.Page) & " WÃŠyg_", 0, 0, Paint.W, H, Align.Center)
  Paint.LineWidth = 1
  Paint.Rectangle(0, 0, Paint.W, H)
  Paint.Stroke
  
  'Paint.DrawText("ABCD",10,)
  
End

