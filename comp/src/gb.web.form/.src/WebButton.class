' Gambas class file

Export
Inherits WebControl

Public Const _Properties As String = "*,Text,Image{ImagePath}"
Public Const _DrawWith As String = "Button"

Property Text As String
Property Image As String

Private $sText As String
Private $sImage As String

Private Function Text_Read() As String

  Return $sText

End

Private Sub Text_Write(Value As String)

  $sText = Value

End

Private Function Image_Read() As String

  Return $sImage

End

Private Sub Image_Write(Value As String)

  $sImage = Value

End

Public Sub _BeforeRender()
  
  Print "<button id=\""; Me.Name; "\">";
  
End


Public Sub _Render()
  
  If $sImage Then Print "<img class=\"button-image\" src=\""; Html(Application.Root &/ Main.CurrentForm.Name &/ $sImage); "\">";
  Print Html($sText);
  
End

Public Sub _AfterRender()
  
  Print "</button>"
  
End
