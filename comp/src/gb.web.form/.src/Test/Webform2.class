' Gambas class file

Public Sub _new()
  
  WebHtml1.Style["font-size"] = "140%"
  WebHtml1.Style["vertical-align"] = "middle"
  
End


Public Sub WebButton1_Click()

  WebTabPanel1.Index = 1 - WebTabPanel1.Index

End

Public Sub WebContainer2_Render()

  Dim cState As Collection
  Dim vVal As Variant
  
  If Session.Id Then
    
    Print "<div style=\"margin:0.5em 0;\"><b>Application state</b></div>"
    cState = Session["#" & LCase(Me.Name)]
    If cState Then
      Print "<table border=\"1\" cellspacing=\"0\" cellpadding=\"4\" style=\"font-size:x-small;border-collapse:collapse;\">"
      For Each vVal In cState
        Print "<tr><td>"; Html(cState.Key); "</td>";
        Print "<td><tt>"; Html(JSON.Encode(vVal)); "</tt></td></tr>"
      Next
      Print "</table>"
    Endif
    
  Endif

End


Public Sub WebForm_Event()

  WebContainer2.Refresh

End

Public Sub WebTabPanel1_Click()

  If WebTabPanel1.Index = 0 Then WebTextBox1.SetFocus

End

Public Sub WebButton4_Click()

  WebComboBox1.Add("Item #" & CStr(WebComboBox1.Count))

End

Public Sub WebButton5_Click()

  WebComboBox1.Clear

End

Public Sub WebTimer1_Timer()

  WebHtml1.Text = Format(Now, gb.LongTime)

End

Public Sub WebButton2_Click()

  Dim hForm As FMessage

  Randomize
  
  hForm = New FMessage
  hForm.Show()
  hForm.Move(Rand(16, 24), Rand(4, 16), 32, 32)
  
Catch
  
  Me.Print(Error.Text & ": " & Error.Backtrace.Join(" "))

End

Public Sub WebButton6_Click()

  WebTimer1.Enabled = Not WebTimer1.Enabled

End

Public Sub WebSlider1_Change()

  WebSpinBox1.Value = WebSlider1.Value

End

Public Sub WebSpinBox1_Change()

  WebSlider1.Value = WebSpinBox1.Value

End
