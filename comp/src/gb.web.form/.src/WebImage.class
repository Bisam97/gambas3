' Gambas class file

Export
Inherits WebControl

Public Const _Properties As String = "*,Image{WebformImage}"

Property Image As String

Private $sImage As String


Public Sub _BeforeRender()
  
  If $sImage Then
    Print "<img"; Me._GetClassId(); " src=\""; Html(Application.Root &/ $sImage); "\"";
    Me._RenderStyleSheet()
    Print ">";
  Else
    Super._BeforeRender()
  Endif
  
End

Public Sub _AfterRender()
  
  If Not $sImage Then Super._AfterRender()
  
End

Private Function Image_Read() As String

  Return $sImage

End

Private Sub Image_Write(Value As String)

  $sImage = Value
  Me._SetProperty("Image", Value)

End


