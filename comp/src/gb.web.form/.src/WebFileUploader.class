' Gambas class file

'Export
Inherits WebControl

Public Const _IsControl As Boolean = True
Public Const _IsVirtual As Boolean = True
Public Const _Properties As String = "*,-Class,-Width,-Height,-Visible,-Expand,-Ignore,Enabled,Delay{Range:0;86400000;10;ms}=1000"
Public Const _Group As String = "Special"
Public Const _DefaultEvent As String = "Progress"

Property Path As String

Event Progress
Private $sPath As Variant

Public Sub _new()
  
End

' Private Function Delay_Read() As Integer
' 
'   Return $iDelay
' 
' End
' 
' Private Sub Delay_Write(Value As Integer)
' 
'   $iDelay = Value
'   Me._SetProperty("Delay", Value)
' 
' End

Public Sub _BeforeRender()
  
End


Public Sub _Render()
  
  Print "<form action=\"x\" method=\"post\" enctype=\"multipart/form-data\">"
  Print "<input class=\"gw-file-input\" type=\"file\" id=\""; Me.Name; "\" name=\"p\""; Me._GetUpdateJS("onchange", "path", "this.value"); ">";
  Print "</form>"
  
End

Public Sub _AfterRender()
  
End

Public Sub Refresh()
  
  If WebForm._InExec Then _Render
  
End

Public Sub _UpdateProperty(sProp As String, vValue As Variant)
  
  If sProp = "path" Then Try Me.Path = vValue
  
End


Private Function Path_Read() As String

  Return $sPath  

End

Private Sub Path_Write(Value As String)

  $sPath = Value
  Me._SetProperty("Path", Value)

End

Public Sub SelectFile()
  
  WebForm._AddReply("gw.file.select(" & JS(Me.Name) & ");")
  
End

Public Sub Download()
  
  
  
End

