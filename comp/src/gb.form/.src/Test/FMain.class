' Gambas class file

' A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment A very long comment 

Private gvwView As MyGridView

Public Sub _new()
  
  Dim I As Integer
  
  gvwView = New MyGridView(Me) As "MyGridView"
  gvwView.Columns.Count = 4
  gvwView.Rows.Count = 1000000
  gvwView.Border = False
  'gvwView.Font.Grade = -1
  
  For I = 0 To gvwView.Columns.Count - 1
    gvwView.Columns[I].Text = "Column #" & CStr(I)
    gvwView.Columns[I].Width = 120
  Next
  
  gvwView.Rows[0].Height = 60
  For I = 1 To 10
    gvwView.Rows[Int(Rnd(0, gvwView.Rows.Count))].Height = 60
  Next
  
End

Private Sub GetCellKey(iRow As Integer, iCol As Integer) As Long
  
  If iRow >= iCol Then
    Return CLong(iRow) * iRow + iCol * 2
  Else
    Return CLong(iCol) * iCol + iRow * 2 + 1
  Endif
  
End

Public Sub MyGridView_Data(Row As Integer, Column As Integer)
  
  gvwView.Data.Text = GetCellKey(Row, Column)
  gvwView.Data.Padding = 2
  
  If Row Mod 10 = 0 Then gvwView.Data.Foreground = Color.Red
  
End
