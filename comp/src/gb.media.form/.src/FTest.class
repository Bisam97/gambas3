' Gambas class file

Private $aVis As String[]
Private $iVis As Integer

Public Sub Button1_Click()

  MediaView1.Volume = Rnd

End

Static Public Sub _init()
  
  Component.Load("gb.form")
  Application.Theme = "gambas-thin"
  
End

Public Sub Button2_Click()

  MediaView1.Visible = Not MediaView1.Visible

End

Public Sub btnOpen_Click()

  If Dialog.OpenFile() Then Return 
  MediaView1.Stop
  MediaView1.URL = Dialog.Path
  MediaView1.Play

End

Public Sub btnTest_Click()

  MediaView1.Stop
  MediaView1.URL = "https://filesamples.com/samples/video/mkv/sample_960x400_ocean_with_audio.mkv"
  'MediaView1.URL = "https://file-examples.com/wp-content/storage/2018/04/file_example_AVI_640_800kB.avi"
  MediaView1.Play

End

Public Sub btnVisualisation_Click()

  If $aVis.Count = 0 Then 
    Error "No visualisation plugin available."
    Return
  Endif
  If $iVis >= $aVis.Count Then $iVis = 0
  Error "set "; $aVis[$iVis]; " visualisation plugin."
  MediaView1.Visualisation = $aVis[$iVis]
  Inc $iVis

End

Public Sub Form_Open()

  Dim sPlugin As String

  $aVis = New String[]
  
  For Each sPlugin In Media.Types
    If InStr(Media[sPlugin].Class, "Visualization") Then $aVis.Add(sPlugin)
  Next

End
