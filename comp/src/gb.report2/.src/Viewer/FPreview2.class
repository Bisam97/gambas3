' Gambas class file

Private $hPrinter As New Printer
Public Sub Form_Open()

  'Me.Center
 ' View.Report = Report2
  'ReportView1.Scale = 0.5
  
End

Static Public Function Run(hReport As Report)
  
  Dim hFPreview As FPreview2
  
  hFpreview = New FPreview2
  
  hFPreview.SetReport(hReport)
  hFpreview.ShowModal()
  
End

Public Sub SetReport(hReport As Report)
  
  View.Report = hReport
  GetValuesFromReport()
  
End

Private Sub GetValuesFromReport()
  
  'cmbPaper.Index = View.Report.Paper
  $hPrinter.Orientation = View.Report.Orientation
  
  If View.Report.Paper = Printer.Custom Then
    'pnlCustom.Enabled = True
    $hPrinter.PaperWidth = TSizeParse[View.Report.Width].ToCm() * 10
    $hPrinter.PaperHeight = TSizeParse[View.Report.Height].ToCm() * 10
  Else
    $hPrinter.Paper = View.Report.Paper
  Endif 
  
  ' cmbOrientation.Index = $hPrinter.Orientation
  ' cmbDuplex.Index = $hPrinter.Duplex
  ' cmbPaper.Index = $hPrinter.Paper
  ' Object.Lock(spWidth)
  ' spWidth.Value = $hPrinter.PaperWidth
  ' Object.Unlock(spWidth)
  ' Object.Lock(spHeight)
  ' spHeight.Value = $hPrinter.PaperHeight
  ' Object.Unlock(spHeight)
  ' 
End