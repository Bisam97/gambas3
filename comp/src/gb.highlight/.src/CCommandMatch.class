' Gambas class file

Inherits CCommand

Private $sFrom As String

Public Sub SetArgs(aArgs As String[])
  
  If aArgs.Count = 1 Then
    $sFrom = aArgs[0]
  Else 
    Error.Raise("Syntax error")
  Endif
  
End

Public Sub Compile(hState As CState)
  
  If CState.IsRegExp($sFrom) Then
  
    CState.Print("sWord = Match(" & Quote(CState.Pattern) & ")")
    CState.Print("If Not sWord Then Goto " & hState.GetNextLabel())
    hState.Forward("String.Len(sWord)")
    
  Else
    
    CState.IfStartWith(CState.Pattern, hState.GetNextLabel())
    hState.Forward(String.Len(CState.Pattern))
    
  Endif

  hState.CompileChildren(hState.GetContinueLabel())
  
End
