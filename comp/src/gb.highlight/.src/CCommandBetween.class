' Gambas class file

Inherits CCommand

Private $sFrom As String
Private $sTo As String

Public Sub SetArgs(aArgs As String[])
  
  If aArgs.Count = 2 Then
    $sFrom = aArgs[0]
    $sTo = aArgs[1]
  Else 
    Error.Raise("Syntax error")
  Endif
  
End

Public Sub Compile(hState As CState)
  
  CState.IfStartWith($sFrom, hState.GetNextLabel())
  
  hState.Forward(String.Len($sFrom))
  
  hState.PrintLabel(hState.GetLabel() & "_LOOP")
  CState.Print("If $bEof Then Return")

  CState.IfStartWith($sTo)
    hState.Forward(String.Len($sTo))
    hState.Continue()
  CState.Print("Endif")

  hState.CompileChildren(True)

End
