' Gambas class file

Private $Scanner As Scanner
Private hImage As Image
Public Sub Form_Open()
  
  Me.Title = "Gambas Easy Scan"
  $Scanner = New Scanner(Settings["Scanner/Name"]) As "Scanner"
End

Public Sub MenuButton1_Mouseup()

  mnugen.Popup(Last.Screenx, Last.ScreenY + Last.Height)

End

Public Sub DrawingArea1_Draw()

 Try Draw.Image(hImage, 0, 0)

End

Public Sub Button3_Click()

  $Scanner["Mode"].Value = Settings["Scanner/Mode"]
  Try $Scanner["Resolution"].Value = Settings["Scanner/Resolution"]
  
  $Scanner.Scan()
End


Public Sub Button1_Click()

  Dim s As String

  For Each s In Scanners
    Print s
  Next

End

Public Sub Scanner_Begin()
  
  
  
End

Public Sub Scanner_Progress()

  ProgressBar1.Value = Last.Progress

End

Public Sub Scanner_Finished()
  
  hImage = Last.Peek()
  If hImage Then DrawingArea1.Refresh
End

Public Sub mnuOption_Click()

  FProperties.ShowModal
   $Scanner = New Scanner(Settings["Scanner/Name"]) As "Scanner"

End
