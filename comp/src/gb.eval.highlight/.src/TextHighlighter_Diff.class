' Gambas class file

Inherits TextHighlighter

Public Const Name As String = "diff"

Public Sub Run(sText As String)
  
  Dim iState As Integer
  
  TextHighlighter.Limit = False
  
  If sText Begins "Index:" Or If sText Begins "diff" Then
    iState = Highlight.Keyword
    TextHighlighter.Limit = True
  Else If sText Begins "===" Then
    iState = Highlight.Keyword
  Else If sText Begins "+++" Then
    iState = Highlight.Operator
  Else If sText Begins "---" Then 
    iState = Highlight.Operator
  Else If sText Begins "+" Then
    iState = Highlight.Number
  Else If sText Begins "-" Then
    iState = Highlight.String
  Else If sText Begins "@" Then
    iState = Highlight.Comment
    TextHighlighter.Limit = True
  Else
    iState = Highlight.Normal
  Endif

  TextHighlighter.Add(iState, String.Len(sText))
  
End
