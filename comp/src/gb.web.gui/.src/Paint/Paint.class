' Gambas class file

Export

Static Private $aStack As New PaintDriver[]

Static Property Read Device As WebControl
Static Property Write LineWidth As Float

Static Private $hCurrent As New PaintDriver

Static Public Sub Begin(Device As WebControl)

  Dim hDriver As PaintDriver
  
  Try hDriver = New ("PaintDriver_" & Object.Type(Device))
  If Error Then Error.Raise("Not a paintable device")
  
  $aStack.Push($hCurrent)
  $hCurrent = hDriver
  $hCurrent.Device = Device
  
  $hCurrent.Begin()
  
End

Static Public Sub End()
  
  If Not $hCurrent.Device Then Return
  
  $hCurrent.End()
  $hCurrent = $aStack.Pop()
  
End

Static Private Function Device_Read() As WebControl

  Return $hCurrent.Device

End

Static Public Sub Save()

  $hCurrent.Save()
  
End

Static Public Sub Restore()
  
  $hCurrent.Restore()
  
End

Static Public Sub Rectangle(X As Float, Y As Float, Width As Float, Height As Float)
  
  $hCurrent.Rectangle(X, Y, Width, Height)
  
End

Static Public Sub Fill(Optional Style As Variant, Optional Preserve As Boolean)
  
  $hCurrent.Fill(Style, Preserve)
  
End

Static Public Sub Stroke(Optional Style As Variant, Optional Preserve As Boolean)
  
  $hCurrent.Stroke(Style, Preserve)
  
End

Static Public Sub MoveTo(X As Float, Y As Float)
  
  $hCurrent.MoveTo(X, Y)
  
End

Static Public Sub LineTo(X As Integer, Y As Integer)
  
  $hCurrent.LineTo(X, Y)
  
End

Static Private Sub LineWidth_Write(Value As Float)

  $hCurrent.SetLineWidth(Value)

End

Static Public Sub Arc(XC As Float, YC As Float, Radius As Float, Optional Angle As Float, Length As Float)
  
  $hCurrent.Arc(XC, YC, Radius, Angle, Length)
  
End

Static Public Sub Ellipse(X As Float, Y As Float, Width As Float, Height As Float, Optional Angle As Float, Length As Float)
  
  $hCurrent.Ellipse(X, Y, Width, Height, Angle, Length)
  
End

Static Public Sub CurveTo(X1 As Float, Y1 As Float, X2 As Float, Y2 As Float, X3 As Float, Y3 As Float)
  
  $hCurrent.CurveTo(X1, Y1, X2, Y2, X3, Y3)
  
End

Static Public Sub NewPath()
  
  $hCurrent.NewPath()
  
End

Static Public Sub ClosePath()
  
  $hCurrent.ClosePath()
  
End

Static Public Sub Clip(Optional Preserve As Boolean)
  
  $hCurrent.Clip(Preserve)
  
End

Static Public Sub SetBrush(Brush As PaintBrush)
  
  $hCurrent.SetBrush(Brush)
  
End

Static Public Sub _GetBrush() As PaintBrush
  
  Return $hCurrent._GetBrush()
  
End


Static Public Sub LinearGradient(X1 As Float, Y1 As Float, X2 As Float, Y2 As Float, Colours As Variant[], Positions As Float[]) As PaintBrush
  
  Return $hCurrent.LinearGradient(X1, Y1, X2, Y2, Colours, Positions)
  
End

Static Public Sub RadialGradient(X1 As Float, Y1 As Float, R1 As Float, X2 As Float, Y2 As Float, R2 As Float, Colours As Variant[], Positions As Float[]) As PaintBrush
  
  Return $hCurrent.RadialGradient(X1, Y1, R1, X2, Y2, R2, Colours, Positions)
  
End

