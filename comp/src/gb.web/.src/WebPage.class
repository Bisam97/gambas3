' Gambas class file

Export
Create Static

Static Private $iLevel As Integer

Property Buffered As Boolean

Private $bBuffered As Boolean

Static Public Sub Main()
  
  Dim hObject As WebPage

  Try hObject = Application.Startup.AutoCreate()
  If Not hObject Then Return
  hObject._Render()
  
End


Public Sub _Render(Optional (_Arg) As Collection)
  
End

Public Sub Render()
  
  If $iLevel = 0 Then
    Response.Buffered = $bBuffered
    Response.Begin
  Endif
  
  Inc $iLevel
  Me._Render()
  
Finally
  
  Dec $iLevel
  
  If $iLevel = 0 Then
    Response.End
  Endif
  
End

Private Function Buffered_Read() As Boolean

  Return $bBuffered

End

Private Sub Buffered_Write(Value As Boolean)

  $bBuffered = Value

End
