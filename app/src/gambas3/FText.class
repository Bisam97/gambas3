' Gambas class file

Static Public Value As String


Static Public Function Run(sText As String) As Boolean

  Dim hForm As Form

  Value = sText
  hForm = New FText

  Return hForm.ShowModal()

End


Public Sub _new()

  txtText.Text = Value
  txtText.SetFocus

  'Config.LoadWindow(ME, "/FText")
  Settings.Read(Me)
  chkFont.Value = Settings["/FText/UseFixedFont", False]
  
End


Public Sub Form_Resize()

  btnCancel.Move(Me.ClientW - 8 - btnCancel.Width, Me.ClientH - 8 - btnCancel.Height)
  btnOK.Move(btnCancel.X - 8 - btnOK.Width, btnCancel.Y)
  txtText.Move(8, 8, Me.ClientW - 16, Me.ClientH - btnCancel.H - 24)
  chkFont.Move(8, btnOK.Y)

End

Public Sub btnCancel_Click()

  Me.Close(True)

End

Public Sub btnOK_Click()

  Value = txtText.Text
  Me.Close

End

Public Sub Form_Close()

  'Config.SaveWindow(ME, "/FText")
  Settings.Write(Me)
  Settings["/FText/UseFixedFont"] = chkFont.Value

End


Public Sub chkFont_Click()

  If chkFont.Value Then
    txtText.Font = Font["Monospace"]
  Else
    txtText.Font = Null
  Endif

End

