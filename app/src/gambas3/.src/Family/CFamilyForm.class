' Gambas class file

Inherits CFamily

Public Const Name As String = "Form"
Public Const DropImageClass As String = "PictureBox"
Public Const DropImageProperty As String = "Picture"
Public Const AllowScaledProperty As Boolean = True
Public Const HasMenuEditor As Boolean = True

Public Sub DrawControl(hCCtrl As CControl) As Boolean
  
  Dim iBorder As Integer
  Dim hCtrl As Control = hCCtrl.Control
  
  'Debug hCCtrl.Name
  
  Select hCCtrl.Kind
  
    Case "HBox"
    
      ' Draw.FillX = 0
      ' Draw.FillY = 0
      ' If hCtrl.H >= 32 Then
      '   Draw.Tile(Picture["img/16/red-arrow-h.png"], 4, 4, hCtrl.W - 8, 8)
      '   Draw.Tile(Picture["img/16/red-arrow-h.png"], 4, hCtrl.H - 12, hCtrl.W - 8, 8)
      ' Else 
      '   Draw.Tile(Picture["img/16/red-arrow-h.png"], 4, hCtrl.H / 2 - 4, hCtrl.W - 8, 8)
      ' Endif
      Draw.Foreground = &HFF8080&
    
    Case "VBox"

      ' Draw.FillX = 0
      ' Draw.FillY = 0
      ' If hCtrl.W >= 32 Then
      '   Draw.Tile(Picture["img/16/red-arrow-v.png"], 4, 4, 8, hCtrl.H - 8)
      '   Draw.Tile(Picture["img/16/red-arrow-v.png"], hCtrl.W - 12, 4, 8, hCtrl.H - 8)
      ' Else 
      '   Draw.Tile(Picture["img/16/red-arrow-v.png"], hCtrl.W / 2 - 4, 4, 8, hCtrl.H - 8)
      ' Endif
      Draw.Foreground = &HFF8080&
    
    Case "HPanel"
    
      ' Draw.FillX = 0
      ' Draw.FillY = 0
      ' If hCtrl.H >= 32 Then
      '   Draw.Tile(Picture["img/16/red-arrow-r.png"], 4, 4, hCtrl.W - 8, 8)
      '   Draw.Tile(Picture["img/16/red-arrow-r.png"], 4, hCtrl.H - 12, hCtrl.W - 8, 8)
      ' Else 
      '   Draw.Tile(Picture["img/16/red-arrow-r.png"], 4, hCtrl.H / 2 - 4, hCtrl.W - 8, 8)
      ' Endif
      Draw.Foreground = &HFF8080&
    
    Case "VPanel"

      ' Draw.FillX = 0
      ' Draw.FillY = 0
      ' If hCtrl.W >= 32 Then
      '   Draw.Tile(Picture["img/16/red-arrow-c.png"], 4, 4, 8, hCtrl.H - 8)
      '   Draw.Tile(Picture["img/16/red-arrow-c.png"], hCtrl.W - 12, 4, 8, hCtrl.H - 8)
      ' Else 
      '   Draw.Tile(Picture["img/16/red-arrow-c.png"], hCtrl.W / 2 - 4, 4, 8, hCtrl.H - 8)
      ' Endif
      Draw.Foreground = &HFF8080&
      
    Case "Panel"
    
      Select Case hCCtrl.GetProperty("Border")
        Case "Raised"
          iBorder = Border.Raised
        Case "Sunken"
          iBorder = Border.Sunken
        Case "Etched"
          iBorder = Border.Etched
        Case "Plain"
          iBorder = Border.Plain
        Default
          iBorder = Border.None
      End Select
      
      If iBorder Then
        Draw.Style.Panel(0, 0, hCtrl.W, hCtrl.H, iBorder)
        Return
      Endif
      'If hCCtrl.GetProperty("Background") Then Return
      Draw.Foreground = &HFF8080&
      'Draw.Foreground = Color.Gradient(Color.Background, &H808080&)
    
    Case Else
      
      Return True

  End Select

  'If hCCtrl["#icon"] Then
  '  Draw.LineStyle = Line.Solid
  'Else
  Draw.LineStyle = Line.Dash
  'Endif
  Draw.Rect(0, 0, hCtrl.W, hCtrl.H)
  Draw.LineStyle = Line.None
  
End

Public Sub EnterControl(hCont As Container, hCCtrl As CControl)
  
  Dim sImage As String
  
  'Debug hCCtrl.Name

  Select hCCtrl.Kind
  
    Case "HBox"
      sImage = "horizontal"
    
    Case "VBox"
      sImage = "vertical"
      
    Case "HPanel"
      sImage = "row"
      
    Case "VPanel"
      sImage = "column"
      
    Case "HSplit"
      sImage = "hsplit"
      
    Case "VSplit"
      sImage = "vsplit"
      
  End Select
  
  Me.DrawIcon(hCont, hCCtrl, sImage)
  
End

