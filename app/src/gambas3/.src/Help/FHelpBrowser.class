' Gambas class file

Property Read {Error} As Boolean

Private $bError As Boolean

Public Sub Form_Open()

  Settings.Read(Me)
  If Not webHelp.Url Then 
    webHelp.Url = MHelp.GetURL() & "?help&" & MHelp.GetHelpLanguage()
    webHelp.TextZoom = 0.8
  Endif

End

Public Sub Form_Close()
  
  Settings.Write(Me)
  
End

Public Sub btnHome_Click()

  webHelp.Url = MHelp.GetURL() & "?help&" & MHelp.GetHelpLanguage()
  webHelp.TextZoom = 0.8

End

Public Sub btnBack_Click()

  webHelp.Back

End

Public Sub btnForward_Click()

  webHelp.Forward

End

Public Sub btnStop_Click()

  webHelp.Stop

End

Public Sub btnReload_Click()

  webHelp.Reload

End

Public Sub btnZoomIn_Click()

  webHelp.TextZoom = Round(webHelp.TextZoom * 1.25, -2)

End

Public Sub btnZoomOut_Click()

  webHelp.TextZoom = Round(webHelp.TextZoom / 1.25, -2)

End

Public Sub btnZoomNormal_Click()

  webHelp.TextZoom = 0.8

End

Public Sub Form_Resize()

  Dim bVisible As Boolean = Me.Height > Desktop.Scale * 30 And Me.Width > Desktop.Scale * 30
  panToolbar.Visible = bVisible
  sepToolbar.Visible = bVisible

End


Public Sub btnWebSite_Click()

  webHelp.Url = "http://gambas.sourceforge.net"
  webHelp.TextZoom = 0.8

End

Public Sub webHelp_Error()

  $bError = True
  btnModify.Enabled = False

End

Public Sub webHelp_Load()

  $bError = False
  btnModify.Enabled = webHelp.Url Begins "http://gambasdoc.org"

End

Private Function Error_Read() As Boolean

  Return $bError

End

Public Sub btnModify_Click()

  Dim sUrl As String
  
  sUrl = webHelp.Url
  If Not (sUrl Begins "http://gambasdoc.org") Then Return
  
  sUrl = Replace(sUrl, "http://gambasdoc.org/help/", "http://gambasdoc.org/edit/")
  
  Project.OpenWebPage(sUrl)

End
