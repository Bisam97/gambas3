' Gambas class file

Private $hEditor As Editor

Public Sub Open(hForm As FEditor, iX As Integer, hSymbol As CSymbolInfo, iArg As Integer, Optional bDoNotUseKey As Boolean)
  
  Dim sSign As String
  Dim $hEditor As Editor
  Dim iY As Integer
  Dim hCont As Container
  Dim sName As String

  $hEditor = hForm.Editor
  Me.Font = $hEditor.Font
  
  sSign = hSymbol.GetSignature(iArg)
  If Not sSign Then Return
  
  sName = hSymbol.Name
  If Left$(sName) = "_" Then sName = hSymbol.Class
  sSign = "<b>" & sName & "</b>" & sSign 
  
  lblNewSignature.W = Max(64, $hEditor.W - 64)
  lblNewSignature.Text = sSign
  lblNewSignature.Adjust
  'lblSignature.AutoResize = FALSE
  lblSignature.W = lblNewSignature.W
  'DEBUG lblSignature.W;; hEditor.W
  lblSignature.Text = sSign
  'lblSignature.AutoResize = TRUE
  'DEBUG "->";; lblSignature.W
  lblSignature.Adjust
  
  Me.Resize(lblSignature.W, lblSignature.H)

  iY = $hEditor.Y + $hEditor.CursorY + $hEditor.LineHeight
  
  If (iY + Me.Height) > ($hEditor.Y + $hEditor.H) Then
    iY = $hEditor.Y + $hEditor.CursorY - Me.Height
  Endif

  hCont = $hEditor.Parent
  Do
    If hCont Is Form Then Break
    iX += hCont.X
    iY += hCont.Y
    hCont = hCont.Parent
  Loop
  
  iX = Max(0, Min(iX, $hEditor.W - Me.Width))

  If Me.Parent = hForm And If iX = Me.X And iY = Me.Y And Me.Visible Then Return

  Me.Reparent(hForm, iX, iY)
  Me.Show
  Me.Raise
  $hEditor.SetFocus
  
End


Public Function ManageKey() As Boolean
  
  Dim iInd As Integer
  
  Select Case Key.Code
  
    Case Key.Esc
      Me.Hide
      Return True
    
    'CASE Key.Backspace
      'ME.Hide
      
  End Select
  
End


Public Sub lblSignature_MouseDown()

  Me.Hide

End
