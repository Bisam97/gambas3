' Gambas class file

Public Path As String
Public (File) As String
Public (Line) As Integer
Public Pos As Integer
Public Column As Integer
Public Text As String
Public Bytes As Integer
Public Length As Integer
Public Dark As Boolean
Public Control As String
Public {Property} As String

Private $sWhere As String

Public Sub GetLocation() As String
  
  Dim hFile As Object
  
  If Not Project.IsSourcePath(Path) Then Return
  If $sWhere Then Return $sWhere
  
  $sWhere = "-"
  Try hFile = Project.LoadFile(Path)
  If hFile Then
    If hFile Is FEditor Or If hFile Is FTextEditor Then
      $sWhere = hFile.GetProcAt({Line})
    Else If hFile Is FForm Then
      $sWhere = hFile.GetLocation({Line})
    Endif
  Endif
  Return $sWhere
  
End
