' Gambas class file

Private $hRequest As HttpForm

Public Sub Run(hRequest As HttpForm, sTitle As String, Optional bProgress As Boolean)

  Dim hObs As Observer
  
  $hRequest = hRequest
  hObs = New Observer(hRequest) As "Request"
  lblRequest.Text = sTitle & "..."
  pgbRequest.Visible = bProgress
  Me.ShowModal
  $hRequest = Null
  
End

Public Sub Request_Error()
  
  Me.Close
  
End

Public Sub Request_Finished()

  Me.Close
  
End

Public Sub Request_Cancel()

  Me.Close
  
End

Public Sub Request_Progress()
  
  If pgbRequest.Visible Then
    Try pgbRequest.Value = $hRequest.Uploaded / $hRequest.TotalUploaded
  Endif
  
End


Public Sub btnCancel_Click()

  $hRequest.Stop

End

Public Sub Form_Open()

  If Not pgbRequest.Visible Then Me.H -= pgbRequest.H

End
