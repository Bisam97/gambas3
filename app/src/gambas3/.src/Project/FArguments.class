' Gambas class file

Static Public Sub Run() As Boolean
  
  Return Not FArguments.ShowDialog()
  
End



Public Sub Form_Open()

  Settings.Read(Me)
  Project.SetEditorFont(lstArg)
  'btnRun.Picture = Project.GetDebuggerIcon("small")
  FillList
  'lstArg.Index = lstArg.Find(FromArgs(Project.CurrentArgument))
  
End

Private Sub FillList()

  Dim aArg As String[]

  lstArg.Clear
  For Each aArg In Project.Arguments
    lstArg.Add(Project.ArgumentsToString(aArg))
  Next
  
  lstArg.SetFocus()

End

Private Sub SaveArgs()

  Dim aArgs As New String[][]
  Dim aList As String[]
  Dim I As Integer

  aList = lstArg.List
  
  For I = 0 To aList.Max
    aArgs.Add(Project.ArgumentsFromString(aList[I]))
  Next
  
  Project.Arguments = aArgs
  Project.WriteProject(True)

End

Public Sub btnOK_Click()

  SaveArgs()
  Me.Close(True)

End

Public Sub Form_Close()
  
  Settings.Write(Me)
  
End


' Public Sub lstArg_Activate()
' 
'   btnRun.Value = True
' 
' End
' 
Public Sub btnCancel_Click()

  Me.Close()

End
