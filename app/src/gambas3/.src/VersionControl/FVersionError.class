' Gambas class file

Static Private $sText As String
Static Private $sDetail As String

Public Sub Run(sText As String, sDetail As String) 

  Dim iBusy As Integer
  
  $sText = sText
  $sDetail = Trim(sDetail)

  iBusy = Application.Busy
  Application.Busy = 0
  Me.ShowModal()
  Application.Busy = iBusy

End

Public Sub btnOK_Click()

  Me.Close

End

Public Sub Form_Open()

  Dim DS, W, H As Integer
  
  DS = Desktop.Scale
  
  lblError.Text = $sText
  
  If $sDetail Then 
  
    Project.SetEditorFont(lblDetail)
    lblDetail.Text = $sDetail
    lblDetail.Border = Border.Plain
    lblDetail.Padding = DS
    With lblDetail.Font
      W = .TextWidth($sDetail)
      H = .TextHeight($sDetail)
    End With
    
  Else
    
    lblDetail.H = DS
    
  Endif
  
  Me.Resize(Max(lblDetail.X + W + DS * 4, 48 * DS), lblDetail.Y + H + DS * 8)

End
