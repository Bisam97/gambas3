' Gambas class file

Static Private $sText As String
Static Private $sDetail As String

Public Sub Run(sText As String, sDetail As String) 

  Dim iBusy As Integer
  
  $sText = sText
  $sDetail = Trim(sDetail)

  iBusy = Application.Busy
  Application.Busy = 0
  Me.ShowModal()
  Application.Busy = iBusy

End

Public Sub btnOK_Click()

  Me.Close

End

Public Sub Form_Open()

  Dim DS As Integer = Desktop.Scale
  
  lblError.Text = Html($sText)
  
  If $sDetail Then 
  
    Project.SetEditorFont(trmDetail)
    MTheme.InitControl(trmDetail)
    trmDetail.Print(Replace($sDetail, "\n", "\r\n"))
    trmDetail.Show
    panExpand.Hide
    Me.Resize(DS * 120, trmDetail.Y + trmDetail.H + DS * 6)
    
  Else
    
    trmDetail.Hide
    panExpand.Show
    Me.Resize(Min(lblError.Font.TextWidth($sText), DS * 40), trmDetail.Y + DS * 6)
    
  Endif
  
End
