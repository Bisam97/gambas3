' Gambas class file

Static Public Value As String[]

Static Public Function Run(aValue As String[]) As Boolean
  
  Dim hForm As Form
  
  Value = aValue
  
  hForm = New FList
  Return NOT hForm.ShowModal()

End


Public Sub Form_Open()

  lstValue.List = Value
  If lstValue.Count Then lstValue.Index = 0
  Refresh

End

Public Sub btnOK_Click()

  Value = lstValue.List
  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close

End

Public Sub lstValue_Click()

  'PRINT "lstValue_Click"

  If NOT lstValue.Current Then Return

  txtValue.Text = lstValue.Current.Text
  txtValue.SetFocus
  txtValue.SelectAll

End


Public Sub txtValue_Change()

  If lstValue.Current Then
    lstValue.Current.Text = txtValue.Text
  Endif

End


Public Sub btnInsert_Click()

  lstValue.Add("Item " & CStr(lstValue.Count + 1))
  'PRINT "Count ="; lstValue.Count
  Refresh
  lstValue.Index = lstValue.Count - 1
  'PRINT "Index ="; lstValue.Index; " /"; lstValue.Count

End


Private Sub Refresh()
  
  Dim bEnabled As Boolean
  
  bEnabled = lstValue.Count
  
  txtValue.Enabled = bEnabled
  btnDelete.Enabled = bEnabled
  btnUp.Enabled = bEnabled
  btnDown.Enabled = bEnabled
  btnClear.Enabled = bEnabled
  
  If NOT bEnabled Then txtValue.Clear
  
End

Public Sub btnDelete_Click()

  Dim iIndex As Integer
  
  iIndex = lstValue.Index

  If iIndex < 0 Then Return
  
  lstValue.Remove(iIndex)

  If iIndex >= lstValue.Count Then Dec iIndex

  lstValue.Index = iIndex

  Refresh

End

Public Sub btnClear_Click()

  If Message.Question(("Do you want to clear the value list ?"), ("Clear"), ("Cancel")) <> 1 Then Return

  lstValue.Clear
  Refresh

End

Public Sub btnDown_Click()

  Dim iInd As Integer

  iInd = lstValue.Index

  If iInd < (lstValue.Count - 1) Then
    Swap lstValue[iInd].Text, lstValue[iInd + 1].Text
    lstValue.Index = iInd + 1
  Endif

End

Public Sub btnUp_Click()

  Dim iInd As Integer

  iInd = lstValue.Index

  If iInd > 0 Then
    Swap lstValue[iInd].Text, lstValue[iInd - 1].Text
    lstValue.Index = iInd - 1
  Endif

End
