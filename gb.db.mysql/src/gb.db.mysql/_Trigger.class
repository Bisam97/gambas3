' Gambas class file

Export
Create Static

' Public Procedure Modify()
' 
' 
' 
' End

Public Procedure Add(Trigger As String, Table As String, {Time} As String, {Event} As String, Statement As String, Optional Database As String)

  If Not Database Then Database = modMain.$Connection.Name
  modMain.RunQuery("CREATE TRIGGER `" & Trigger & "` " & {Time} & " " & {Event} & " ON `" & Database & "`.`" & Table & "` FOR EACH ROW " & Statement)

End

Public Procedure Delete(Trigger As String, IfExists As Boolean, Optional DataBase As String)

  If Not Database Then Database = modMain.$Connection.Name
  modMain.$Query = "DROP TRIGGER "
  If IfExists Then modMain.$Query &= "IF EXISTS "
  modMain.$Query &= "`" & DataBase & "`.`" & Trigger & "`"
  modMain.RunQuery(modMain.$Query)

End

Public Function Info(Trigger As String, Optional DataBase As String) As String

  If Not Database Then Database = modMain.$Connection.Name
  Return modMain.$Connection.Exec("SELECT `ACTION_STATEMENT` FROM `information_schema`.`TRIGGERS` WHERE `TRIGGER_SCHEMA` = '" & Database & "' AND `TRIGGER_NAME` = '" & Trigger & "'")!ACTION_STATEMENT

End

' Public Procedure Rename(Table As String, NewTable As String)
' 
' 
' 
' End
