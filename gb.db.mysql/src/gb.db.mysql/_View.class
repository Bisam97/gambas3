' Gambas class file

Export
Create Static

Public Procedure Modify(View As String, Statement As String)

  Add(View, Statement, True)

End

Public Procedure Add(View As String, Statement As String, Optional {Replace} As Boolean)

  'TODO: Quote the Statement parameter
  modMain.$Query = "CREATE"
  If {Replace} Then modMain.$Query &= " OR REPLACE"
  modMain.$Query &= " VIEW " & DB.Quote(View) & " AS " & Statement
  modMain.RunQuery(modMain.$Query)

End

Public Procedure Delete(Views As String[], IfExists As Boolean)

  modMain.$Query = "DROP VIEW "
  If IfExists Then modMain.$Query &= "IF EXISTS "
  modMain.$Query &= modMain.ArrayToString(Views, True)
  modMain.RunQuery(modMain.$Query)

End
